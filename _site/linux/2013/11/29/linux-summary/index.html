
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>linux 小总结</title>
        <meta name="description" content="linux 小总结">
        <meta name="author" content="寞踪">

        <!-- Enable responsive viewport -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- Le styles -->
        <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
        <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
        <script src="/assets/themes/twitter/google-code-prettify/jquery.js"></script>
        <script src="/assets/themes/twitter/google-code-prettify/prettify.js"></script>
        <link href="/assets/themes/twitter/google-code-prettify/sunburst.css" rel="stylesheet" type="text/css" media="all">
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine">
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Inconsolata">
        <script type="text/javascript">
            $(function(){
                $("pre").addClass("prettyprint");
                prettyPrint();

                // hide #back-top first
                $("#back-top").hide();

                // fade in #back-top
                $(function () {
                    $(window).scroll(function () {
                        if ($(this).scrollTop() > 400) {
                            $('#back-top').fadeIn();
                        } else {
                            $('#back-top').fadeOut();
                        }
                });

                // scroll body to 0px on click
                $('#back-top a').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                        }, 800);
                    return false;
                    });
                });

            });
        </script>
        <!-- Le fav and touch icons -->
    <!-- Update these with your own images
        <link rel="shortcut icon" href="images/favicon.ico">
        <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
        <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->

        <!-- atom & rss feed -->
        <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
        <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    </head>

    <body>
        <p id="back-top"><a href="#top"><i class="fa fa-chevron-circle-up fa-3x"></i> <br> </a> </p>
        <div class="navbar navbar-inverse">
            <div class="navbar-inner">
                <div class="container-narrow">
                    <a class="brand" href="/">寞踪的技术博客</a>
                    <ul class="nav">
                        
                        
                        


  
    
      
      	
      	<li><a href="/aboutMe.html">关于我</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">存档</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">分类</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/open.html">开源</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/pages.html">页面</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">标签</a></li>
      	
      
    
  



                    </ul>
                </div>
            </div>
        </div>

        <div class="container-narrow">

            <div class="content">
                
<div class="page-header">
    <h1>linux 小总结 </h1>
</div>

<div class="row-fluid post-full">
    <div class="span12">
        <div class="date">
            <span>2013-11-29</span>
        </div>
        <div class="content">
            <ul>
    <li>作者：<a href='http://weibo.com/xpmozong' target='blank'>寞踪</a></li>
    <li>本文地址：http://xpmozong.github.io/linux/2013/11/29/linux-summary/</li>
    <li>转载请注明出处</li>
</ul><p>1、初始安装</p>
<pre><code>yum install make apr* autoconf automake gcc gcc-c++ openssl openssl-devel pcre-devel gd  kernel keyutils perl kernel-headers compat* mpfr cpp glibc libgomp libstdc++-devel ppl cloog-ppl keyutils-libs-devel libcom_err-devel libsepol-devel libselinux-devel krb5-devel zlib-devel libXpm* freetype libjpeg* libpng* ncurses* libtool* libxml2 libxml2-devel patch</code></pre>
<p>2、日志20行</p>
<pre><code>cat error.log | awk &#39;{print $1}&#39;|sort|uniq -c|sort -nr|head -20</code></pre>
<p>3、运行C程序</p>
<pre><code>yum -y install gcc
yum -y install gcc-c++ 
yum install make
// 编译 
gcc hello.c -o hello</code></pre>
<p>4、加全局变量</p>
<pre><code>编辑： vim /root/.bash_profile
添加： export PATH=$PATH:/usr/local/go/bin
运行： source /root/.bash_profile
可以通过 echo $PATH 来查看环境变量
vim .bashrc
source .bashrc</code></pre>
<p>5、Centos查看端口占用情况命令，比如查看80端口占用情况使用如下命令：</p>
<pre><code>lsof -i tcp:80</code></pre>
<p>6、列出所有端口</p>
<pre><code>netstat -ntlp</code></pre>
<p>7、查看进程</p>
<pre><code>ps -ef | grep nginx</code></pre>
<p>8、按照这个步骤启动uwsgi</p>
<pre><code>ps aux | grep uwsgi
pkill uwsg
screen
uwsgi -x /data/funny/uwsgi.xml
chown -R www:www /tmp/funny.sock</code></pre>
<p>9、列出文件夹下文件夹大小</p>
<pre><code>du -sh /data/*  </code></pre>
<p>10、定时执行修改</p>
<pre><code>crontab -e
/etc/init.d/crond restart</code></pre>
<p>11、复制</p>
<pre><code>// 复制指定目录的文件到当前目录，并重命名
cp ~/.bashrc bashrc_bak

// 强制复制指定目录的文件到当前目录，而不管当前目录是否含有该文件
cp -f ~/.bashrc bashrc

// 复制指定目录到当前目录
cp -r /root/test .
cp -r /root/test/ .

// 复制指定目录的文件到指定目录
cp ~/.bashrc /bak/.bashrc
// 若提示：
cp: omitting directory
// 则采用：
cp -r ~/.bashrc /bak/.bashrc
// 若提示：
cp:overwrite
// 则采用加斜杠：
/cp -r -f ~/.bashrc /bak/.bashrc

// 在复制时将源文件的全部属性也复制过来。若不指定参数，则目标文件与源文件属性可能不一致。
cp -a ~/.bashrc /bak/.bashrc

// 若两个文件夹要保证同步，一个文件的改了，另一个文件也跟着改，但是要保证两个文件的文件都是最新的。
cp -u /src/.bashrc /bak_src/bashrc</code></pre>
<p>12、重命名文件夹</p>
<pre><code>mv oldfilename newfilename</code></pre>
<p>13、防火墙</p>
<pre><code>// 关闭
/etc/init.d/iptables stop
// 添加例外端口 
vim /etc/sysconfig/iptables
-A INPUT -p tcp -m tcp --dport 55 -j ACCEPT</code></pre>
<p>14、查找文件</p>
<pre><code>find / -name access_log</code></pre>
<p>15、网桥</p>
<pre><code>brctl show</code></pre>
<p>16、noVNC</p>
<pre><code>yum install python-devel
nohup /data/noVNC/utils/launch.sh &amp;
// 普通访问
/data/noVNC/utils/websockify.py -D 8000 192.168.1.1:5900
http://192.168.1.1:6080/vnc_auto.html?host=192.168.1.1&amp;port=8000
// proxy访问
/data/noVNC/utils/websockify --target-config=/data/noVNC/vnc_tokens 29876
http://192.168.1.1:6080/vnc_auto.html?host=192.168.1.1&amp;port=29876&amp;token=212oukhdvszujihzqvm</code></pre>
<p>17、virsh、qemu命令</p>
<pre><code>// 远程连接
virsh -c qemu+tls://192.168.1.1:23/system list --all
// 创建磁盘
qemu-img create -f qcow2 -o preallocation=metadata /data/vm/test2.qcow2 8G
// 编辑虚拟机文件
virt-edit -d 912-2 /root/meta.js
// 挂载虚拟机磁盘
guestmount --rw -a /data/qyinstances/instance-11354/disk.qcow2 -m /dev/sda1 /mnt/qyvms/

fusermount -u /mnt/tmp1</code></pre>
<p>18、将文件转成镜像</p>
<pre><code>mkisofs -r -o meta.iso meta.js</code></pre>
<p>19、挂载文件</p>
<pre><code>mount /dev/sr0 /media/</code></pre>
<p>20、查看硬盘还剩多少容量</p>
<pre><code>df -h
fdisk -l</code></pre>
<p>21、获取IP地址</p>
<pre><code>dhclient -d eth0</code></pre>
<p>22、随机生成mac地址</p>
<pre><code>MACADDR=&quot;52:54:$(dd if=/dev/urandom count=1 2&gt;/dev/null | md5sum | sed &#39;s/^\(..\)\(..\)\(..\)\(..\).*$/\1:\2:\3:\4/&#39;)&quot;; echo $MACADDR</code></pre>
<p>23、更改文件或文件夹所属</p>
<pre><code>chown qemu.qemu /dev/kvm</code></pre>
<p>24、修改ip</p>
<pre><code>vim /etc/sysconfig/network-scripts/ifcfg-em1</code></pre>
<p>25、查看网线有没有连接</p>
<pre><code>mii-tool em2</code></pre>
<p>26、获得掩码</p>
<pre><code>cat /etc/sysconfig/network-scripts/ifcfg-public | grep -i netmask  </code></pre>
<p>27、获得网关</p>
<pre><code>route -n | awk &#39;{print $2}&#39; | tail -1</code></pre>
<p>28、salt学习</p>
<pre><code>salt-key -L
salt-key -d opstest
salt &quot;*&quot; grains.items
salt &quot;*&quot; grains.item id
salt &quot;*&quot; grains.item ipv4
// 分发文件 
salt &#39;hadoop1&#39; cp.get_file salt://test.txt /data/test.txt</code></pre>
<p>29、SCP</p>
<pre><code>// 从本地复制到远程
scp -P 22 /data/iso/test.txt admin@192.168.1.1:/data/iso/
// 从远程复制到本地
scp -P 22 root@192.168.1.1:/data/vm/test.txt /data/iso/test.txt</code></pre>
<p>30、判断一文件是否存在</p>
<pre><code>test -f /data/iso/centos6.3.qcow2;echo $?
// 0为有文件，其他为无文件</code></pre>
<p>31、ssh 登录</p>
<pre><code>ssh -p 22 -i id_rsa admin@192.168.1.1</code></pre>
<p>32、rpm删不掉的话 用这个</p>
<pre><code>rpm -e opennebula-sunstone-4.0.0-1.x86_64 --noscripts</code></pre>
<p>33、添加用户并登陆</p>
<pre><code>useradd opsvmadmin
groupadd opsvmadmin
usermod -a -G opsvmadmin opsvmadmin
vim /etc/ssh/sshd_config
// 加入 AllowGroups opsvmadmin
/etc/init.d/sshd restart</code></pre>
<p>34、检测某段内ip是否可用</p>
<pre><code>fping -t 500 -g  192.168.1.1 192.168.1.128</code></pre>
<p>35、ll 不可用的时候</p>
<pre><code>vim ~/.bashrc  alias ll=&#39;ls -l --color=auto&#39;</code></pre>
<p>36、看某个文件逐渐增加的</p>
<pre><code>watch &quot;ls -l&quot;</code></pre>
<p>37、打包</p>
<pre><code>tar zcvf noVNC.tar.gz noVNC/</code></pre>
<p>38、证书使用包</p>
<pre><code>yum install -y gnutls-utils</code></pre>
<p>39、查看iptables 列表</p>
<pre><code>iptables -L -n</code></pre>
<p>40、输出CPU使用率、输出内存使用率</p>
<pre><code>cat /proc/stat | grep cpu | head -1 | awk &#39;{sum=$2+$3+$4+$5+$6+$7+$8;use=$2+$3+$4+$6+$7+$8;printf &quot;%s\t%.2f%%\n&quot;,$1,(use*100/sum)}&#39;
free | grep Mem: | awk &#39;{use=$3-$6-$7;printf &quot;%s\t%.2f%%\n&quot;,$1,(use*100/$2)}&#39;</code></pre>
        </div>

    
        <ul class="tag_box inline">
            <li><i class="icon-folder-open"></i></li>
            
            


  
     
    	<li><a href="/categories.html#linux-ref">
    		linux <span>2</span>
    	</a></li>
    
  


        </ul>
        

    
        <ul class="tag_box inline">
            <li><i class="icon-tags"></i></li>
            
            


  
     
    	<li><a href="/tags.html#LINUX-ref">LINUX <span>1</span></a></li>
    
  



        </ul>
        

        <hr>
        <div class="pagination">
            <ul>
            
                <li class="prev"><a href="/mysql/2013/11/28/mysql-summary" title="mysql 小总结">&larr; Previous</a></li>
            
                <li><a href="/archive.html">Archive</a></li>
            
                <li class="next"><a href="/php/2013/12/05/lnmp" title="Linux + Nginx + Mysql + PHP 编译安装">Next &rarr;</a></li>
            
            </ul>
        </div>
        <hr>
        


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




    </div>
</div>


            </div>
            <footer>
                <p>&copy; 2014 寞踪
                    with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
                    and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
                </p>
            </footer>

        </div>

        
    </body>
</html>

